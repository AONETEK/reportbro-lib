# reportbro-lib tests

reportbro-lib uses pytest as test runner. Run with the following command in the root directory:

```
poetry run pytest
```
or to run a specific test use the `-k` parameter like:
```
poetry run pytest -k test_report_demo_render[invoice]
```

## Demo tests
Test for demo files are defined in `tests/test_report_render.py. All demo tests added to the `DEMOS` list are run.

Each demo has a directory in `tests/data/demos/` with the following content:

* a json file called like the demo (e.g. `invoice.json`) containing the report definition
* report.pdf or report.pdf.checksum
* report.xlsx or  report.xlsx.checksum
* data.json (optional)

If no `data.json` is found the test parameters from the report definition are used (if any).
The checksum files can be used to omit the generated report in case of large reports.

### Regenerate test data

In case the report definition or the data of a test changes it can be regenerated by running:

```
poetry run scripts/regenerate_test_report_output.py
```

This re-generates **all** demo tests defined. Adapt the scripts if test data for a single test
should only be generated.
